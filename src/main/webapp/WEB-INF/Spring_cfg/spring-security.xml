<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:security="http://www.springframework.org/schema/security"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/security
       http://www.springframework.org/schema/security/spring-security.xsd">

    <!--<security:http pattern="/resources/**" security="none" />-->
    <security:http>
        <security:intercept-url pattern="/pages/login.xhtml" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <!--<security:intercept-url pattern="/resources/css/*" access="IS_AUTHENTICATED_ANONYMOUSLY"/>-->
        <security:intercept-url pattern="/javax.faces.resource/**" access="IS_AUTHENTICATED_ANONYMOUSLY"/>
        <security:intercept-url pattern="/pages/security/department.xhtml" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:intercept-url pattern="/pages/security/**" access="ROLE_ADMIN" />
        <security:intercept-url pattern="/**" access="IS_AUTHENTICATED_ANONYMOUSLY" />
        <security:form-login login-page='/login' default-target-url='/'
                             always-use-default-target='true'/>
    </security:http>

    <security:authentication-manager>
        <security:authentication-provider>
            <security:user-service>
                <security:user name="admin" password="admin" authorities="ROLE_USER, ROLE_ADMIN" />
                <!--<security:user name="bob" password="bobspassword" authorities="ROLE_USER" />-->
            </security:user-service>
        </security:authentication-provider>
        <security:authentication-provider ref="daoAuthenticationProvider"/>
    </security:authentication-manager>

    <bean id="userDetailsService"
          class="org.drorzz.dao.serurity.UserDetailsServiceImpl">
    </bean>

    <bean id="daoAuthenticationProvider"
          class="org.springframework.security.authentication.dao.DaoAuthenticationProvider">
        <property name="userDetailsService" ref="userDetailsService"/>
        <!--<property name="passwordEncoder" ref="passwordEncoder"/>-->
    </bean>
</beans>